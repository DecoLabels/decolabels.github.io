
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="shortcut icon" type="image/jpg" href="./img/logo.ico"/>
		<meta name='robots' content='noindex, nofollow'/>
    <title>Inventory Management | Deco Labels</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css">
	<link rel="stylesheet" href="./css/deco-styles.css">
	<script src="./js/jquery-3.6.0.min.js"></script>
	<script src="./js/deco-app.js"></script>
	<script type="text/JavaScript" src="https://cdnjs.cloudflare.com/ajax/libs/jQuery.print/1.6.0/jQuery.print.js"></script>
  </head>
  <body>
  <section class="section">
    <div class="container">
      <div class="columns is-centered">
	<div class="column is-half p-0">
		<a class="" href="./index.html">
			<img class="logo" src="./img/deco-logo.jpg" alt="Deco Labels"/>
		</a>
	</div>
	</div>		
    </div>
  </section>
   <section class="section py-0 px-3">
		<div class="searchbox pb-4 noprint">
			
		   <div class="field has-addons">
			  
			  <div class="control columns search-box production-entry mx-0">				
				<input placeholder="Enter customer" id="sortby" name="sortbycustomer" list="sortbycustomer" class="select-list column">
				<datalist id="sortbycustomer">					
					<option value="SUMMER FRESH SALADS INC.">
					<option value="FGF BRANDS INC">
					<option value="CANADA BREAD COMPANY LIMITED">
					<option value="SOFINA FOODS INC (BRAMPTON)">
					<option value="CONCORD PREMIUM MEATS LTD">
					<option value="BUNZL CANADA INC BURLINGTON">
					<option value="SOFINA FOODS INC. (BRAMPTON)">
					<option value="2213256 ONTARIO LTD.">
					<option value="IMPERIAL DADE CANADA INC.">
					<option value="VIENNA MEAT - SOFINA FOODS INC.">
					<option value="COMMERCIAL BAKERIES CORPORATION">
					<option value="SANTE MANUFACTURING INC.">
					<option value="SHOPPERS DRUG MART">
					<option value="BIMBO BAKEHOUSE">
					<option value="BATTISTONI ITALIAN SPECIALTY MEATS">
					<option value="FROG BOX (2267605 ONTARIO INC.)">
					<option value="LOBLAW INC">
					<option value="SOFINA FOODS INC (MITCHELL)">
					<option value="TAYLOR FRESH FOODS">
				</datalist>			  
			  <div class="control get-bol">
				<a class="button is-info search-ticket p-5">Get Back Oder List</a>
			  </div>

			  </div>			  
		   </div>			
		</div>
		<div class="loader-wrapper">
            	     <div class="loader is-loading"></div>
        	</div>
		<!-- list item -->
		<div class="back-order-list">
		<div class="">
			<h1 class="is-size-4 has-text-weight-bold"></h1>
		</div>
		<div class="list is-clearfix" id="listtoprint" style="display:none;"></div>
		</div>
		<!-- list item -->
		<div class="container" >		
			<div class="field has-text-centered mt-6 print-button" style="margin-bottom:8rem;display:none;">
				<button class="button is-primary is-medium">PRINT</button>
			</div>			
		</div>
  </section>
  <nav class="navbar is-fixed-bottom" role="navigation" aria-label="main navigation">
	<div class="navbar-item">    
		<a class="" href="./index.html"><img class="home-icon image is-48x48" src="./img/home-icon.png" alt="HOME"/></a>
	</div>
  </nav>



<script>
var backOrderList=[];
getBackOrderList();

$('.search-ticket').click(function(){
	
	var customerName = $('#sortby').val();
	var customerID = $('option[value="'+customerName+'"]').data('id');

	var resultHtml = "";
	var count = 0;

	if(customerName != '' || typeof(customerName) == undefined){
		backOrderList.filter(function( item ) {
			//if((item.product_number).substr(0,6) == customerID){
			if(item.customer == customerName && item.BackOrder > 0 && item.shipped > 0){
				resultHtml += '<div class="list-item row-'+item.row+'">'+
				  		 '<div class="list-item-content" id="'+item.id+'">'+
							'<div class="list-item-title" data-id="'+item.product_number+'"><b>'+item.product_number+'</b></div>'+
								 '<div class="list-item-description columns">'+
									 '<div class="column is-9">'+
										'<span class="dpn">'+item.description+ '</span><br>'+
										'<span class="ordrqty" data-qty="'+item.order_qty+'">Ordered QTY: '+item.order_qty+ '</span>'+
										'<span class="bol px-2">Back Order: '+ item.BackOrder +'</span>'+	
										'<span class="ticketnum px-2">Ticket Number: '+item.id +'</span>'+	
										'<span class="ponum px-2">Shipped: '+item.shipped +'</span>'+
									 '</div>'+
									 '<div class="column is-3 noprint">'+
										'<button class="button is-dark" onclick="pickProduct('+item.row+')">Pick Order</button>'+
									 '</div>'+		
								'</div>'+														
							'</div>'+													
						'</div>';
				count++;
			}
		});
if(count > 0){
	$('.back-order-list h1').text(customerName);
	$('.back-order-list .list').html(resultHtml);
	$('.back-order-list .list').css('display','block');
}else{
	$('.back-order-list h1').text("No Back Order Available.");
}
	}else{
		alert("Please select customer.");	
	}


});

function getBackOrderList(){
	$.ajax({
		headers: {'Accept' : 'application/json'},
		type: 'GET',
		url: "https://script.google.com/macros/s/AKfycbyz41PpsyM77NkNhqf6dsah3W5ApSPGIapH-Nrd1EqFNkS4rYYQ98dEwr5WI8Q65vjcGA/exec?action=read&table=order_to_pick",
		beforeSend: function(xhr){
		xhr.withCredentials = true;
		},
		success: function (response, textStatus, request){
				var filteredList = response.data;				
				backOrderList = filteredList.sort(function(a, b){return (b.product_number < a.product_number) ? 1 : -1;}).sort(function(a, b){return (b.id < a.id) ? 1 : -1;});
			
			}
		});
			
}




</script>
  </body>
</html>
