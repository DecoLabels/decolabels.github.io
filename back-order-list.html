
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="shortcut icon" type="image/jpg" href="./img/logo.ico"/>
		<meta name='robots' content='noindex, nofollow'/>
    <title>Inventory Management | Deco Labels</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css">
	<link rel="stylesheet" href="./css/deco-styles.css">
	<script src="./js/jquery-3.6.0.min.js"></script>
	<script src="./js/deco-app.js"></script>
	<script type="text/JavaScript" src="https://cdnjs.cloudflare.com/ajax/libs/jQuery.print/1.6.0/jQuery.print.js"></script>
  </head>
  <body>
  <section class="section">
    <div class="container">
      <div class="columns is-centered">
	<div class="column is-half p-0">
		<a class="" href="./index.html">
			<img class="logo" src="./img/deco-logo.jpg" alt="Deco Labels"/>
		</a>
	</div>
	</div>		
    </div>
  </section>
   <section class="section py-0 px-3">
		<div class="searchbox pb-4 noprint">
			
		   <div class="field has-addons">
			  
			  <div class="control columns search-box production-entry mx-0">				
				<input placeholder="Enter customer" id="sortby" name="sortbycustomer" list="sortbycustomer" class="select-list column">
				<datalist id="sortbycustomer">					
					<option value="2213256 ONTARIO LTD. FRESHOUSE" data-id="FRE011">
					<option value="AD CREATIVE CORP" data-id="ADC003">
					<option value="ARTERRA WINES CANADA" data-id="RJS001">
					<option value="ASTERIX SECURITY" data-id="AST001">
					<option value="ATLANTIC LIFTS" data-id="ATL001">
					<option value="BATTISTONI ITALIAN SPECIALTY MEATS" data-id="BAT007">
					<option value="BEARSKIN AIRLINES | PERIMETER AVIATION" data-id="PER023">
					<option value="BIMBO BAKEHOUSE" data-id="WHO001">
					<option value="BRIDGEWAY PRINTING" data-id="BRI007">
					<option value="BUNZL CANADA INC BURLINGTON" data-id="BUN001">
					<option value="CAMAD" data-id="CAM012">
					<option value="CANADA BREAD COMPANY LIMITED" data-id="CAN093">
					<option value="CANADIAN CANNING INC." data-id="CAN130">
					<option value="CANPLAS INDUSTRIES LTD" data-id="CAN009">
					<option value="CARGILL FOODS - GUELPH" data-id="CAR034">
					<option value="CELTRADE CANADA INC." data-id="CEL006">
					<option value="CHRISTAN MARK" data-id="CHR009">
					<option value="COMMERCIAL BAKERIES CORPORATION" data-id="COM050">
					<option value="COMPASS GROUP CANADA" data-id="COM034">
					<option value="CONCORD PREMIUM MEATS LTD" data-id="CON027">
					<option value="CRAFT COAST CANNING" data-id="CRA006">
					<option value="CREATIVE MINDS PACKAGING" data-id="CRE015">
					<option value="CRYSTAL CLAIRE COSMETICS" data-id="CRY002">
					<option value="DECO LABELS & TAGS" data-id="DEC006">
					<option value="DRADER MANUFACTURING IND" data-id="DRA005">
					<option value="DUSTRONICS INC" data-id="DUS002">
					<option value="EATON CORPORATION" data-id="EAT002">
					<option value="ESP MARKETING SERVICES" data-id="ESP001">
					<option value="EXCELDOR COOPERATIVE" data-id="EXC009">
					<option value="FAST TRACK PACKAGING" data-id="FAS004">
					<option value="FGF BRANDS INC" data-id="FGF001">
					<option value="FIRST CHOICE BEVERAGE INC" data-id="FIR017">
					<option value="FOAM SOLUTIONS INC." data-id="FAB001">
					<option value="FORSYTHE LUBRICATION ASSOCIATES LTD." data-id="FOR001">
					<option value="FRESH DIRECT PRODUCE" data-id="FRE016">
					<option value="FRESHLINE FOODS" data-id="FRE013">
					<option value="FROG BOX (2267605 ONTARIO INC.)" data-id="FRO002">
					<option value="FUTURE TRANSFER CO INC" data-id="FTC001">
					<option value="GIVE AND GO PREPARED FOODS CORP" data-id="GIV003">
					<option value="GREENWOOD MUSHROOM FARM" data-id="GRE015">
					<option value="HOMETECH WINDOW CORP" data-id="HOM004">
					<option value="HUBERGROUP CANADA LIMITED" data-id="HOS001">
					<option value="HUNTER AMENITIES" data-id="HUN009">
					<option value="I-GARD CORPORATION" data-id="IPC001">
					<option value="IMPERIAL DADE CANADA INC." data-id="UNI029">
					<option value="IMPRESSIVE LABELS" data-id="IMP022">
					<option value="JAN K. OVERWEEL LTD./ZADI FOODS" data-id="JAN001">
					<option value="LAMY AMERICA" data-id="CEN012">
					<option value="LITENS AUTOMOTIVE PARTNERSHIP" data-id="LIT001">
					<option value="LOBLAW INC" data-id="LOB001">
					<option value="LONGEVITY ACRYLICS LIMITED" data-id="LON001">
					<option value="MAGNOTTA WINERY ESTATES LTD" data-id="MAG010">
					<option value="MAPLE LEAF FOODS INC" data-id="MAP026">
					<option value="MARATHON BUSINESS FORMS" data-id="MAR045">
					<option value="MARK IV PROMOTIONS INC" data-id="MAR042">
					<option value="MASCO CANADA LTD - PLUMBING GROUP" data-id="DEL003">
					<option value="MMIS INCORPORATED" data-id="MMI001">
					<option value="MONAGHAN MUSHROOMS LTD" data-id="MON006">
					<option value="MONCO PRODUCE INC." data-id="MON008">
					<option value="NICHE BAKERS CORP" data-id="NIC005">
					<option value="OAKVILLE FIRE DEPARTMENT" data-id="OAK002">
					<option value="ONTARIO MEDICAL OXYGEN SERVICES" data-id="BRO018">
					<option value="PARSON A.D.L. INC" data-id="PAR001">
					<option value="PETRO CANADA LUBRICANTS" data-id="PET014">
					<option value="PREMIER TECH HOME AND GARDEN" data-id="SPE017">
					<option value="PROPRINT SERVICES INC" data-id="PRO033">
					<option value="PSC CLEANING SYSTEMS INC" data-id="PSC001">
					<option value="RAVINE MUSHROOM FARMS INC" data-id="RAV001">
					<option value="REGIONAL MUNICIPALITY OF DURHAM" data-id="DUR003">
					<option value="REXALL PHARMACY GROUP" data-id="REX002">
					<option value="RICHARDSON OILSEED" data-id="MAT009">
					<option value="ROY TURK INDUSTRIAL SALES" data-id="ROY024">
					<option value="SAFEGUARD BUSINESS SYSTEMS" data-id="SAF008">
					<option value="SANTE MANUFACTURING INC." data-id="SAN015">
					<option value="SCHNEIDER ELECTRIC" data-id="FED010">
					<option value="SELECT FOOD PRODUCTS LTD" data-id="SEL003">
					<option value="SFI GROUP LIMITED" data-id="SFI001">
					<option value="SHOPPERS DRUG MART" data-id="SHO001">
					<option value="SM JALEEL AND COMPANY LTD." data-id="SMJ001">
					<option value="SOFINA FOODS INC" data-id="SOF003">
					<option value="ST HELEN'S MEAT PACKERS LIMITED" data-id="STH001">
					<option value="Stampede Culinary Partners, Inc." data-id="DEL016">
					<option value="STAPLES" data-id="IBF001">
					<option value="STEEL FIRE EQUIPMENT" data-id="RST001">
					<option value="SUMMER FRESH SALADS INC." data-id="SUM007">
					<option value="TEKNION LIMITED" data-id="TEK001">
					<option value="THE CUPCAKE SHOPPE" data-id="CUP001">
					<option value="THE ESSENTIAL IMAGE" data-id="ESS001">
					<option value="TRI-PAK CORP." data-id="TRI026">
					<option value="UPS CANADA" data-id="UPS001">
					<option value="VIENNA MEAT -  SOFINA FOODS INC." data-id="VIE001">
					<option value="WESTROCK  COMPANY OF CANADA CORP." data-id="MCL002">
					<option value="WINDHAM PACKAGING" data-id="WIN013">
					<option value="WOLF STEEL LTD" data-id="WOL002">
				</datalist>			  
			  <div class="control get-bol">
				<a class="button is-info search-ticket p-5">Get Back Oder List</a>
			  </div>

			  </div>			  
		   </div>			
		</div>
		<div class="loader-wrapper">
            	     <div class="loader is-loading"></div>
        	</div>
		<!-- list item -->
		<div class="back-order-list">
		<div class="">
			<h1 class="is-size-4 has-text-weight-bold"></h1>
		</div>
		<div class="list is-clearfix" id="listtoprint" style="display:none;"></div>
		</div>
		<!-- list item -->
		<div class="container" >		
			<div class="field has-text-centered mt-6 print-button" style="margin-bottom:8rem;display:none;">
				<button class="button is-primary is-medium">PRINT</button>
			</div>			
		</div>
  </section>
  <nav class="navbar is-fixed-bottom" role="navigation" aria-label="main navigation">
	<div class="navbar-item">    
		<a class="" href="./index.html"><img class="home-icon image is-48x48" src="./img/home-icon.png" alt="HOME"/></a>
	</div>
  </nav>



<script>
var backOrderList=[];
getBackOrderList();

$('.search-ticket').click(function(){
	
	var customerName = $('#sortby').val();
	var customerID = $('option[value="'+customerName+'"]').data('id');

	var resultHtml = "";
	var customerName = "";

	if(customerID != '' || typeof(customerID) == undefined){
		backOrderList.filter(function( item ) {
			if((item.ProductNo).substr(0,6) == customerID){
				resultHtml += '<div class="list-item row-'+item.row+'">'+
				  		 '<div class="list-item-content" id="'+item.Ticket+'">'+
							'<div class="list-item-title" data-id="'+item.ProductNo+'"><b>'+item.ProductNo+'</b></div>'+
								 '<div class="list-item-description columns">'+
									 '<div class="column is-9">'+
										'<span class="dpn">'+item.Description+ '</span><br>'+
										'<span class="ordrqty" data-qty="'+item.OrderedQty+'">QTY: '+item.OrderedQty+ '</span>'+
										'<span class="bol px-2">Back Order: '+ item.BackOrder +'</span>'+	
										'<span class="ticketnum px-2">Ticket Number: '+item.TicketNum +'</span>'+	
										'<span class="ponum px-2">PO Number: '+item.PO +'</span>'+
									 '</div>'+
									 '<div class="column is-3 noprint">'+
										'<button class="button is-dark" onclick="pickProduct('+item.row+')">Pick Order</button>'+
									 '</div>'+		
								'</div>'+														
							'</div>'+													
						'</div>';

			}
		});

	$('.back-order-list h1').text(customerName);
	$('.back-order-list .list').html(resultHtml);
	$('.back-order-list .list').css('display','block');

	}else{
		alert("Please select customer.");	
	}


});

function getBackOrderList(){
	$.ajax({
		headers: {'Accept' : 'application/json'},
		type: 'GET',
		url: "https://script.google.com/macros/s/AKfycbyz41PpsyM77NkNhqf6dsah3W5ApSPGIapH-Nrd1EqFNkS4rYYQ98dEwr5WI8Q65vjcGA/exec?action=read&table=backorder",
		beforeSend: function(xhr){
		xhr.withCredentials = true;
		},
		success: function (response, textStatus, request){
				var filteredList = response.data;				
				backOrderList = filteredList.sort(function(a, b){return (b.TicketNum < a.TicketNum) ? 1 : -1;}).sort(function(a, b){return (b.PO < a.PO) ? 1 : -1;});
			
			}
		});
			
}




</script>
  </body>
</html>
